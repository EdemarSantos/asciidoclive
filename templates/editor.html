{# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
 #                         Copyright (C) 2014 Chuan Ji                         #
 #                             All Rights Reserved                             #
 # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
 # Editor page template. #}
{% extends 'base.html' %}

{% from 'dialog.html' import Dialog, LoadingDialog, SuccessDialog %}

{% set default_page_title = 'AsciiDocLIVE - free online AsciiDoc editor' %}

{% block title %}{{ default_page_title }}{% endblock title %}

{% block head_extra %}
  <script type="text/javascript">
    window.EditorParams = {
        document_id:
            {% if document %}
              '{{ document.document_id }}',
            {% else %}
              null,
            {% endif %}
        document_title:
            {% if document and document.title %}
              '{{ document.title }}',
            {% else %}
              null,
            {% endif %}
        default_document_title: 'Untitled Document',
        default_page_title: '{{ default_page_title }}',
        page_title_suffix: ' - AsciiDocLIVE',
    };
  </script>

{% endblock head_extra %}

{% block header %}{% include 'editor_header.html' %}{% endblock header %}

{% block main %}
  {% if document %}
    {% set asciidoc_editor_text = document.text %}
  {% endif %}
  {% include 'asciidoc_editor.html' %}

  {# Edit title dialog. #}
  {% call Dialog('edit-title') %}
    <div class="prompt">Edit title</div>
      <input type="text" class="ui-input-text">
    <div class="actions">
      <a href="#"
         class="ui-button ui-button-cancel">Cancel</a>
      <span class="divider">&nbsp;</span>
      <a href="#"
         class="ui-button ui-button-ok">Save</a>
    </div>
  {% endcall %}

  {# Dialogs. #}
  {{ LoadingDialog('saving', 'Saving...') }}
  {{ SuccessDialog('saving-success', 'Saved') }}
  {{ SuccessDialog('saving-not-changed', 'No changes since last save') }}

  {# Message for the leave confirmation dialog. #}
  <div id="unload-confirmation-message" class="hidden">
    If you leave this page, all data you have entered on this page will be lost.

    Please make sure to save any data you would like to keep by copying it from
    this page and saving it on your computer.
  </div>

  {# Editor client-side code. #}
  <script type="application/dart"
          src="{{ url_for('static', filename='editor.dart') }}"></script>
  <script src="{{ url_for('static', filename='packages/browser/dart.js') }}"></script>
{% endblock main %}
